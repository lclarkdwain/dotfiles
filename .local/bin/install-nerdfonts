#!/usr/bin/env bash

# Helper script to install nerd-fonts on Ubuntu.

REPO="ryanoasis/nerd-fonts"
FONT_DIR="$DOTFILES_DIR/.local/share/fonts"
RED='\033[0;31m'
NC='\033[0m' # No Color

latest_release() {
  local repo=$1
  local result=$(curl --silent "https://api.github.com/repos/$repo/releases/latest" | grep -Po '"tag_name": "\K.*?(?=")')
  echo "$result"
}

install() {
  local fontname=$1

  local zip_url="https://github.com/$REPO/releases/download/$version/$fontname.zip"
  local zip_file="$FONT_DIR/$fontname.zip"

  echo -e "==> Downloading font ${RED}$fontname${NC} ......"
  wget -P "$FONT_DIR" "$zip_url"

  unzip "$zip_file" -d "$FONT_DIR" || {
    echo "Error unzipping $fontname."
    return 1
  }

  rm "$zip_file"

  fc-cache -fv
  echo "==> done!"
}

echo "==> Fetching latest release version of $REPO"
version=$(latest_release $REPO)
echo "==> Latest version is: $version"

mkdir -p "$FONT_DIR/fonts"

# install_font FiraCode
# install_font Iosevka
# install_font FantasqueSansMono
# install_font Lekton
# install_font Inconsolata
# install_font VictorMono
# install_font InconsolataGo
# install_font Monofur
# install JetBrainsMono
# install_font CascadiaCode
install_font Hack
